{"remainingRequest":"/Users/lirongzhi/Documents/深圳善链/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lirongzhi/Documents/深圳善链/src/view/wallet/extract/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lirongzhi/Documents/深圳善链/src/view/wallet/extract/index.vue","mtime":1572538946853},{"path":"/Users/lirongzhi/Documents/深圳善链/node_modules/cache-loader/dist/cjs.js","mtime":1572539003414},{"path":"/Users/lirongzhi/Documents/深圳善链/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport navBar from '../../../component/navBar';\nimport mixins from '../../../common/mixin';\nimport Footer from '../../../component/footer/footer';\nimport CheckPassword from '../../../component/checkPassword';\nimport countTo from 'vue-count-to';\nimport { Dialog, Toast } from 'vant';\n\nexport default {\n    components: {\n        Footer,\n        navBar,\n        CheckPassword,\n        Toast,\n        Dialog,\n        countTo\n    },\n    mixins: [mixins],\n    data: () => ({\n        title: '',\n        withdraw: {},       // 初始化的数据\n        arrival: 0,         // 到账数量\n        amount: null,       // 转账数量\n        address: '',        // 转账地址\n        userInfo: {},       // 用户信息\n        showCheckPassword: false\n    }),\n    created() {\n\n    },\n    mounted() {\n        this.address = \"\";\n        this.title = this.$route.query.title;\n        this.handleLoad();\n        if(this.$route.query.addres){\n            this.address = this.$route.query.addres;\n        }\n        if(this.$route.query.amount) {\n            this.amount = this.$route.query.amount;\n        }\n    },\n    // 设置路由钩子，存储页面来源\n    beforeRouteEnter(to, from, next) {\n        next(vm=>{          //  这里的vm指的就是vue实例，可以用来当做this使用\n            sessionStorage.setItem('url_from', from.path);\n        })\n    },\n    methods: {\n        // 历史记录\n        handleHistory: function() {\n            this.$router.push({\n                path: '/walletExtractHistory',\n                query: {\n                    id: this.$route.query.id\n                }\n            });\n        },\n        // 钱包地址\n        handleAddres: function() {\n            this.$router.push({\n                path: '/walletAddresIndex',\n                query: {\n                    id: this.$route.query.id,\n                    title: this.$route.query.title,\n                    amount: this.amount\n                }\n            });\n        },\n        // 初始化\n        handleLoad: function() {\n            this.request({\n                url: 'api/withdraw',\n                method: 'GET',\n                data: {\n                    currency_id: this.$route.query.id\n                },\n                success: (response) => {\n                    this.withdraw = response;\n                    this.withdraw.charge_num = Number(this.withdraw.charge_num).toFixed(2);\n\n                    // 判断是否有URL参数\n                    if(this.$route.query.addres){\n                        this.address = this.$route.query.addres;\n                    }\n                    if(this.$route.query.amount) {\n                        console.log(this.withdraw)\n                        this.amount = Number(this.$route.query.amount);\n                        this.handleArrival()\n                    }\n                },\n                error: (response) => {\n\n                },\n                complete: (response) => {\n\n                }\n            });\n        },\n        // 转账\n        handleSubmit: function () {\n            // 手续费\n            if(this.withdraw.id == 3) {             //  是UTD才执行\n                if(Number(this.arrival) <= 0) {\n                    this.$toast.center('转账数量不能小于0');\n                    return\n                }\n            }\n            // 最小限额\n            if(Number(this.amount) < Number(this.withdraw.min_single_nums)) {\n                this.$toast.center('转账数量低于最小限额');\n                return\n            }\n            // 提现数字超出余额\n            if(Number(this.amount) > Number(this.withdraw.max_month_nums)) {\n                this.$toast.center('转账数量超出当月限额');\n                return\n            } else {\n                if(Number(this.amount) > Number(this.withdraw.max_day_nums)) {\n                    this.$toast.center('转账数量超出当日限额');\n                    return\n                }\n            }\n            // 转账地址\n            let myreg = /^0x[a-fA-F0-9]{40}$/;\n            if(!myreg.test(this.address)) {\n                this.$toast.center('转账地址不合法');\n                return\n            }\n            // 打开校验密码\n            this.showCheckPassword = !this.showCheckPassword;\n        },\n        // 校验密码回调\n        handleCheckPassword: function (password) {\n            // 密码校验\n            this.request({\n                url: 'api/check',\n                method: 'POST',\n                data: {\n                    password: password\n                },\n                success: (response) => {\n                    this.handleWithdraw();\n                },\n                error: (response) => {\n\n                },\n                complete: (response) => {\n                }\n            });\n        },\n        // 确认转账\n        handleWithdraw: function() {\n            this.request({\n                url: 'api/withdraw',\n                method: 'PATCH',\n                data: {\n                    currency_id: this.$route.query.id,\n                    address: this.address,\n                    amount: Number(this.amount)\n                },\n                success: (response) => {\n                    this.$toast.center('提交成功');\n\n                    this.$router.replace({\n                        path: '/shopkeeperLoading',\n                        query: {\n                            name: '资产划转',\n                            type: 'integral'\n                        }\n                    });\n\n                    // this.$router.push({\n                    //     path: '/walletExtractDetail',\n                    //     query: {\n                    //         id: response.id\n                    //     }\n                    // });\n                },\n                error: (response) => {\n                },\n                complete: (response) => {\n                    this.showCheckPassword = false;\n                }\n            });\n        },\n        // 校验密码返回回调\n        handleBack: function () {\n            this.showCheckPassword = !this.showCheckPassword;\n        },\n        // 计算到账数量\n        handleArrival: function () {\n            this.arrival = Number(this.amount) - Number(this.withdraw.charge_num);\n            this.arrival = this.arrival > 0 ? this.arrival : 0;\n\n            if(Number(this.withdraw.max_day_nums) <= 0) {\n                this.$toast.center('转账数量不合法');\n\n                this.amount = 0\n            }\n        },\n        // 选择全部\n        handleAll: function () {\n            if(Number(this.withdraw.astir_currency) < Number(this.withdraw.max_day_nums)){\n                this.amount = this.withdraw.astir_currency;\n                this.handleArrival();\n            } else{\n                this.amount = Number(this.withdraw.max_day_nums);\n                this.handleArrival();\n            }\n        }\n    }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmFA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/view/wallet/extract","sourcesContent":["<template>\n    <div class=\"recharge\">\n        <navBar :title=\"title + '提币'\"></navBar>\n        <span class=\"recharge-history\" v-if=\"!showCheckPassword\" @click=\"handleHistory\">\n            <img src=\"./image/icon04.png\" alt=\"\">\n        </span>\n        <div class=\"main\">\n            <div class=\"main-body\">\n                <div class=\"main-body-title\">提币金额</div>\n                <div class=\"main-body-input\">\n                    <div class=\"left\">\n                        <input type=\"text\"\n                               v-model=\"amount\"\n                               @input=\"handleArrival\"\n                               :placeholder=\"'当前余额 ' + withdraw.astir_currency\"\n                               class=\"address-input\" />\n                    </div>\n                    <div class=\"right\" @click=\"handleAll\">\n                        <img src=\"./image/icon01.png\" alt=\"\">\n                    </div>\n                </div>\n                <div class=\"main-body-number margin-bottom-15\">\n                    <span class=\"day\">\n                        当月可提\n                        <countTo :startVal='0' :decimals=\"2\" :endVal='Number(withdraw.max_month_nums ? withdraw.max_month_nums : 0)' :duration='1'></countTo>\n                        {{withdraw.short}}\n                    </span>\n                    <span class=\"month\" @click=\"handleAll\">\n                        当日可提\n                        <countTo :startVal='0' :decimals=\"2\" :endVal='Number(withdraw.max_day_nums ? withdraw.max_day_nums : 0)' :duration='1'></countTo>\n                        {{withdraw.short}}\n                    </span>\n                </div>\n            </div>\n            <div class=\"main-body\">\n                <div class=\"main-body-title\">收款地址</div>\n                <div class=\"main-body-input\">\n                    <div class=\"left\" @click=\"handleAddres\">\n                        <input type=\"text\"\n                               disabled\n                               v-model=\"address\"\n                               placeholder=\"请选择收款地址\"\n                               class=\"address-input\" />\n                    </div>\n                    <div class=\"right\">\n                        <img src=\"./image/icon02.png\" alt=\"\">\n                    </div>\n                </div>\n            </div>\n            <div class=\"main-body\" style=\"margin-top: 30px;\">\n                <div class=\"main-body-title\">手续费</div>\n                <div class=\"main-body-momey\">\n                    <span>{{withdraw.charge_num}} UTD</span>\n                    <img src=\"./image/icon03.png\" alt=\"\">\n                </div>\n                <div class=\"main-body-tisp\">\n                    <p>最小转账数量为：<b>{{this.withdraw.min_single_nums}}</b> {{withdraw.short}}。</p>\n                    <p>为保障资金安全，我们会对资产转账进行人工审核，请耐心等待工作人员信息处理。</p>\n                    <p>请务必确认电脑及浏览器全，防止信息被篡改或泄露。</p>\n                </div>\n            </div>\n            <div class=\"actual\">\n                <div class=\"actual-title\">到账金额</div>\n                <div class=\"actual-number\">\n                    <countTo v-if=\"withdraw.id == 3\" :startVal='0' :decimals=\"2\" :endVal='Number(arrival ? arrival : 0)' :duration='1'></countTo>\n                    <countTo v-else :startVal='0' :decimals=\"2\" :endVal='Number(amount ? amount : 0)' :duration='1'></countTo>\n                    {{withdraw.short}}\n                </div>\n            </div>\n            <div class=\"from-submit\" @click=\"handleSubmit\">提交</div>\n        </div>\n\n        <transition name=\"slide-fade\">\n            <CheckPassword v-if=\"showCheckPassword\"\n                           @handleCheckPassword=\"handleCheckPassword\"\n                           @handleBack=\"handleBack\" />\n        </transition>\n    </div>\n</template>\n\n<style src=\"./index.css\" scoped></style>\n\n<script>\n    import navBar from '../../../component/navBar';\n    import mixins from '../../../common/mixin';\n    import Footer from '../../../component/footer/footer';\n    import CheckPassword from '../../../component/checkPassword';\n    import countTo from 'vue-count-to';\n    import { Dialog, Toast } from 'vant';\n\n    export default {\n        components: {\n            Footer,\n            navBar,\n            CheckPassword,\n            Toast,\n            Dialog,\n            countTo\n        },\n        mixins: [mixins],\n        data: () => ({\n            title: '',\n            withdraw: {},       // 初始化的数据\n            arrival: 0,         // 到账数量\n            amount: null,       // 转账数量\n            address: '',        // 转账地址\n            userInfo: {},       // 用户信息\n            showCheckPassword: false\n        }),\n        created() {\n\n        },\n        mounted() {\n            this.address = \"\";\n            this.title = this.$route.query.title;\n            this.handleLoad();\n            if(this.$route.query.addres){\n                this.address = this.$route.query.addres;\n            }\n            if(this.$route.query.amount) {\n                this.amount = this.$route.query.amount;\n            }\n        },\n        // 设置路由钩子，存储页面来源\n        beforeRouteEnter(to, from, next) {\n            next(vm=>{          //  这里的vm指的就是vue实例，可以用来当做this使用\n                sessionStorage.setItem('url_from', from.path);\n            })\n        },\n        methods: {\n            // 历史记录\n            handleHistory: function() {\n                this.$router.push({\n                    path: '/walletExtractHistory',\n                    query: {\n                        id: this.$route.query.id\n                    }\n                });\n            },\n            // 钱包地址\n            handleAddres: function() {\n                this.$router.push({\n                    path: '/walletAddresIndex',\n                    query: {\n                        id: this.$route.query.id,\n                        title: this.$route.query.title,\n                        amount: this.amount\n                    }\n                });\n            },\n            // 初始化\n            handleLoad: function() {\n                this.request({\n                    url: 'api/withdraw',\n                    method: 'GET',\n                    data: {\n                        currency_id: this.$route.query.id\n                    },\n                    success: (response) => {\n                        this.withdraw = response;\n                        this.withdraw.charge_num = Number(this.withdraw.charge_num).toFixed(2);\n\n                        // 判断是否有URL参数\n                        if(this.$route.query.addres){\n                            this.address = this.$route.query.addres;\n                        }\n                        if(this.$route.query.amount) {\n                            console.log(this.withdraw)\n                            this.amount = Number(this.$route.query.amount);\n                            this.handleArrival()\n                        }\n                    },\n                    error: (response) => {\n\n                    },\n                    complete: (response) => {\n\n                    }\n                });\n            },\n            // 转账\n            handleSubmit: function () {\n                // 手续费\n                if(this.withdraw.id == 3) {             //  是UTD才执行\n                    if(Number(this.arrival) <= 0) {\n                        this.$toast.center('转账数量不能小于0');\n                        return\n                    }\n                }\n                // 最小限额\n                if(Number(this.amount) < Number(this.withdraw.min_single_nums)) {\n                    this.$toast.center('转账数量低于最小限额');\n                    return\n                }\n                // 提现数字超出余额\n                if(Number(this.amount) > Number(this.withdraw.max_month_nums)) {\n                    this.$toast.center('转账数量超出当月限额');\n                    return\n                } else {\n                    if(Number(this.amount) > Number(this.withdraw.max_day_nums)) {\n                        this.$toast.center('转账数量超出当日限额');\n                        return\n                    }\n                }\n                // 转账地址\n                let myreg = /^0x[a-fA-F0-9]{40}$/;\n                if(!myreg.test(this.address)) {\n                    this.$toast.center('转账地址不合法');\n                    return\n                }\n                // 打开校验密码\n                this.showCheckPassword = !this.showCheckPassword;\n            },\n            // 校验密码回调\n            handleCheckPassword: function (password) {\n                // 密码校验\n                this.request({\n                    url: 'api/check',\n                    method: 'POST',\n                    data: {\n                        password: password\n                    },\n                    success: (response) => {\n                        this.handleWithdraw();\n                    },\n                    error: (response) => {\n\n                    },\n                    complete: (response) => {\n                    }\n                });\n            },\n            // 确认转账\n            handleWithdraw: function() {\n                this.request({\n                    url: 'api/withdraw',\n                    method: 'PATCH',\n                    data: {\n                        currency_id: this.$route.query.id,\n                        address: this.address,\n                        amount: Number(this.amount)\n                    },\n                    success: (response) => {\n                        this.$toast.center('提交成功');\n\n                        this.$router.replace({\n                            path: '/shopkeeperLoading',\n                            query: {\n                                name: '资产划转',\n                                type: 'integral'\n                            }\n                        });\n\n                        // this.$router.push({\n                        //     path: '/walletExtractDetail',\n                        //     query: {\n                        //         id: response.id\n                        //     }\n                        // });\n                    },\n                    error: (response) => {\n                    },\n                    complete: (response) => {\n                        this.showCheckPassword = false;\n                    }\n                });\n            },\n            // 校验密码返回回调\n            handleBack: function () {\n                this.showCheckPassword = !this.showCheckPassword;\n            },\n            // 计算到账数量\n            handleArrival: function () {\n                this.arrival = Number(this.amount) - Number(this.withdraw.charge_num);\n                this.arrival = this.arrival > 0 ? this.arrival : 0;\n\n                if(Number(this.withdraw.max_day_nums) <= 0) {\n                    this.$toast.center('转账数量不合法');\n\n                    this.amount = 0\n                }\n            },\n            // 选择全部\n            handleAll: function () {\n                if(Number(this.withdraw.astir_currency) < Number(this.withdraw.max_day_nums)){\n                    this.amount = this.withdraw.astir_currency;\n                    this.handleArrival();\n                } else{\n                    this.amount = Number(this.withdraw.max_day_nums);\n                    this.handleArrival();\n                }\n            }\n        }\n    }\n</script>\n"]}]}