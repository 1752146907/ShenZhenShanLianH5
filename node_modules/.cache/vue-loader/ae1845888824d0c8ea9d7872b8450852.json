{"remainingRequest":"/Users/lirongzhi/Documents/深圳善链/h5/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lirongzhi/Documents/深圳善链/h5/src/view/plus/shopx/category/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lirongzhi/Documents/深圳善链/h5/src/view/plus/shopx/category/index.vue","mtime":1572538946841},{"path":"/Users/lirongzhi/Documents/深圳善链/h5/node_modules/cache-loader/dist/cjs.js","mtime":1572539003414},{"path":"/Users/lirongzhi/Documents/深圳善链/h5/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport mixins from '../../../../common/mixin';\nimport navBar from '../../../../component/navBar';\nimport '../component/goods/goods.css';\n\nexport default {\n    components: {\n        navBar\n    },\n    mixins: [mixins],\n    data: () => ({\n        loading: false,         // 滚动加载参数\n        finished: false,         // 滚动加载参数\n        page: 1,\n        size: 20,\n        categoryId: '',\n        name: '',\n        title: '',\n        goodsList: [],\n        transferRecord: {},\n        historyList: []\n    }),\n    // 设置路由钩子，存储页面来源\n    beforeRouteEnter(to, from, next) {\n        next(vm => {          //  这里的vm指的就是vue实例，可以用来当做this使用\n            sessionStorage.setItem('url_from', from.path);\n        })\n    },\n    created() {\n        if (this.$route.query.id) {\n            this.categoryId = this.$route.query.id;\n        }\n        if (this.$route.query.name) {\n            this.name = this.$route.query.name;\n        }\n        this.title = this.$route.query.title\n    },\n    mounted() {\n        this.handleGoodsList();\n    },\n    methods: {\n        // 商品详情\n        handleGoods: function (id) {\n            this.$router.push({\n                path: '/plus/shopx/goods',\n                query: {\n                    id: id\n                }\n            })\n        },\n        // 下拉加载\n        rollLoad: function () {\n            if(this.historyList.length < this.transferRecord.total) {\n                this.page += 1;\n                this.handleGoodsList();\n            } else{\n                this.loading = false;\n                this.finished = true;\n            }\n        },\n        handleGoodsList() {\n            if(this.$route.query.id) {\n                var requestData = {\n                    page: this.page,\n                    size: this.size,\n                    category_id: this.categoryId\n                }\n            } else{\n                var requestData = {\n                    page: this.page,\n                    size: this.size,\n                    name: this.name\n                }\n            }\n            this.request({\n                url: 'api/store/goods',\n                method: 'GET',\n                data: requestData,\n                success: (response) => {\n                    this.goodsList = response;\n                    this.transferRecord = response;\n\n                    // 价格切割\n                    this.transferRecord.list.map((data) => {\n                        if(data.min_price) {\n                            data.goods_min_price_num = data.min_price.substring(data.min_price.length - 2);\n                            data.min_price = data.min_price.substring(0, data.min_price.length - 2);\n                        }\n                    });\n\n                    // 如果从搜索页面进来，没搜索到数据，返回到搜索页\n                    if (this.$route.query.isSeach && this.transferRecord.list.length <= 0) {\n                        this.$router.replace({\n                            path: '/plus/shopx/seach',\n                            query: {\n                                noSeach: true,\n                                name: this.name\n                            }\n                        });\n                    }\n\n                    // 把数组拼接上去\n                    this.historyList = this.historyList.concat(this.transferRecord.list);\n                },\n                error: (response) => {\n\n                },\n                complete: () => {\n\n                }\n            });\n        },\n        handleBack: function () {\n            // 如果从搜索页面进来，返回到搜索页\n            if (this.$route.query.isSeach) {\n                this.$router.replace({\n                    path: '/plus/shopx/seach',\n                    query: {\n                        name: this.name\n                    }\n                });\n            } else {\n                this.$router.go(-1)\n            }\n        }\n    }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/view/plus/shopx/category","sourcesContent":["<template>\n    <div class=\"category\">\n        <div class=\"bar\">\n            <div class=\"bar-box\">\n                <van-icon class=\"bar-back\" name=\"arrow-left\" @click=\"handleBack\" size=\"20\" />\n                <!--<img class=\"bar-back\" src=\"../image/back.png\" alt=\"\">-->\n                {{title}}\n            </div>\n        </div>\n\n        <van-list v-model=\"loading\"\n                  :finished=\"finished\"\n                  :offset=\"300\"\n                  :immediate-check=\"false\"\n                  finished-text=\"没有更多了\"\n                  class=\"goods-box\"\n                  @load=\"rollLoad\" >\n            <div class=\"goods\">\n                <div class=\"goods-item\"\n                     @click=\"handleGoods(item.id)\"\n                     v-for=\"(item, index) in historyList\"\n                     :key=\"index\">\n                    <div class=\"goods-item-hander-box\">\n                        <div class=\"goods-item-hander\">\n                            <img v-if=\"item.image[0]\" :src=\"item.image[0].file.path\" alt=\"\">\n                        </div>\n                    </div>\n                    <div class=\"goods-item-body\">\n                        <div class=\"title line-clamp-two\">{{item.name.length > 15 ?item.name.substring(0,20)+ \"...\":item.name}}</div>\n                        <div class=\"price\">\n                            <span class=\"rmb\">¥</span>\n                            {{item.min_price}}\n                            <span class=\"num\">{{item.goods_min_price_num}}</span>\n                            <s v-if=\"item.sku[0]\">{{item.sku[0].line_price}}元</s>\n                        </div>\n                        <div class=\"goods-item-body-tab\">\n                            <strong v-for=\"children in item.available_pay_type\"\n                                    :key=\"children\">\n                                <span v-if=\"children == 1\">ETH</span>\n                                <span v-if=\"children == 2\">INE</span>\n                                <span v-if=\"children == 3\">UTD</span>\n                            </strong>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </van-list>\n    </div>\n</template>\n<style src=\"./index.css\" scoped></style>\n<script>\n    import mixins from '../../../../common/mixin';\n    import navBar from '../../../../component/navBar';\n    import '../component/goods/goods.css';\n\n    export default {\n        components: {\n            navBar\n        },\n        mixins: [mixins],\n        data: () => ({\n            loading: false,         // 滚动加载参数\n            finished: false,         // 滚动加载参数\n            page: 1,\n            size: 20,\n            categoryId: '',\n            name: '',\n            title: '',\n            goodsList: [],\n            transferRecord: {},\n            historyList: []\n        }),\n        // 设置路由钩子，存储页面来源\n        beforeRouteEnter(to, from, next) {\n            next(vm => {          //  这里的vm指的就是vue实例，可以用来当做this使用\n                sessionStorage.setItem('url_from', from.path);\n            })\n        },\n        created() {\n            if (this.$route.query.id) {\n                this.categoryId = this.$route.query.id;\n            }\n            if (this.$route.query.name) {\n                this.name = this.$route.query.name;\n            }\n            this.title = this.$route.query.title\n        },\n        mounted() {\n            this.handleGoodsList();\n        },\n        methods: {\n            // 商品详情\n            handleGoods: function (id) {\n                this.$router.push({\n                    path: '/plus/shopx/goods',\n                    query: {\n                        id: id\n                    }\n                })\n            },\n            // 下拉加载\n            rollLoad: function () {\n                if(this.historyList.length < this.transferRecord.total) {\n                    this.page += 1;\n                    this.handleGoodsList();\n                } else{\n                    this.loading = false;\n                    this.finished = true;\n                }\n            },\n            handleGoodsList() {\n                if(this.$route.query.id) {\n                    var requestData = {\n                        page: this.page,\n                        size: this.size,\n                        category_id: this.categoryId\n                    }\n                } else{\n                    var requestData = {\n                        page: this.page,\n                        size: this.size,\n                        name: this.name\n                    }\n                }\n                this.request({\n                    url: 'api/store/goods',\n                    method: 'GET',\n                    data: requestData,\n                    success: (response) => {\n                        this.goodsList = response;\n                        this.transferRecord = response;\n\n                        // 价格切割\n                        this.transferRecord.list.map((data) => {\n                            if(data.min_price) {\n                                data.goods_min_price_num = data.min_price.substring(data.min_price.length - 2);\n                                data.min_price = data.min_price.substring(0, data.min_price.length - 2);\n                            }\n                        });\n\n                        // 如果从搜索页面进来，没搜索到数据，返回到搜索页\n                        if (this.$route.query.isSeach && this.transferRecord.list.length <= 0) {\n                            this.$router.replace({\n                                path: '/plus/shopx/seach',\n                                query: {\n                                    noSeach: true,\n                                    name: this.name\n                                }\n                            });\n                        }\n\n                        // 把数组拼接上去\n                        this.historyList = this.historyList.concat(this.transferRecord.list);\n                    },\n                    error: (response) => {\n\n                    },\n                    complete: () => {\n\n                    }\n                });\n            },\n            handleBack: function () {\n                // 如果从搜索页面进来，返回到搜索页\n                if (this.$route.query.isSeach) {\n                    this.$router.replace({\n                        path: '/plus/shopx/seach',\n                        query: {\n                            name: this.name\n                        }\n                    });\n                } else {\n                    this.$router.go(-1)\n                }\n            }\n        }\n    }\n</script>\n"]}]}