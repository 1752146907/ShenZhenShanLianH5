{"remainingRequest":"/Users/lirongzhi/Documents/深圳善链/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lirongzhi/Documents/深圳善链/src/view/login/password/checkPhone.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lirongzhi/Documents/深圳善链/src/view/login/password/checkPhone.vue","mtime":1572538946795},{"path":"/Users/lirongzhi/Documents/深圳善链/node_modules/cache-loader/dist/cjs.js","mtime":1572539003414},{"path":"/Users/lirongzhi/Documents/深圳善链/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {DropdownMenu, DropdownItem, Toast} from 'vant';\nimport mixins from '../../../common/mixin';\nimport navBar from '../../../component/navBar';\n\nexport default {\n    components: {\n        DropdownMenu,\n        DropdownItem,\n        Toast,\n        navBar\n    },\n    mixins: [mixins],\n    data: () => ({\n        option1: [\n            {text: '+86', value: 0},\n            {text: '+89', value: 1},\n            {text: '+00', value: 2}\n        ],\n        mobile: '',       // 手机号码\n        code: '',         // 验证码\n        codeTime: 60,       // 手机倒计时\n        isCode: false,      // 是否显示发生验证码\n        isActivw: false,  // 是否激活登录按钮\n        value1: 0\n    }),\n    created() {\n\n    },\n    methods: {\n        handleNext: function () {\n            this.request({\n                url: 'api/forgetPassword',\n                method: 'POST',\n                data: {\n                    mobile: this.mobile,\n                    code: this.code\n                },\n                success: (response) => {\n                    this.handleLogin();\n                },\n                error: (response) => {\n                },\n                complete: () => {\n                    Toast.clear();\n                }\n            });\n        },\n        handleLogin: function () {\n            this.request({\n                url: 'api/login',\n                data: {\n                    mobile: this.mobile,\n                    code: this.code\n                },\n                success: (response) => {\n                    this.$router.replace({\n                        path: '/forgetPassword',\n                        query: {\n                            code: this.code\n                        }\n                    });\n\n                    // 存储access_token\n                    let access_token = response.token_type + ' ' + response.access_token;\n                    this.$storage.setToken(access_token);\n\n                    // 存储过期时间戳\n                    let d = new Date();\n                    let times = d.getTime() + response.expires_in\n                    this.$storage.setTimeStamp(times);\n                },\n                error: (response) => {\n                },\n                complete: () => {\n                    Toast.clear();\n                }\n            });\n        },\n        handleGetCode: function () {\n            if(!this.handleChackPnone(this.mobile)){\n                Toast(\"请输入正确的手机格式\");\n                return;\n            }\n\n            Toast.loading({\n                mask: true,\n                message: '发送中...'\n            });\n\n            this.request({\n                url: 'api/sendMobileCode',\n                data: {\n                    mobile: this.mobile\n                },\n                success: (response) => {\n                    this.isCode = !this.isCode;\n\n                    let timer = setInterval(() => {\n                        if(this.codeTime > 0) {\n                            this.codeTime = this.codeTime - 1;\n                        } else {\n                            this.codeTime = 60;\n                            this.isCode = !this.isCode;\n\n                            clearInterval(timer)\n                        }\n                    }, 1000)\n                },\n                error: (response) => {\n                },\n                complete: () => {\n\n                }\n            });\n        },\n        handleGetStatus: function (value) {\n            if(this.mobile.length > 11) {\n                this.mobile = this.mobile.slice(0, 11)\n                Toast(\"请输入正确的手机格式\");\n                return;\n            }\n\n            if(this.mobile.length > 0 & this.code.length > 0) {\n                this.isActivw = true;\n            } else{\n                this.isActivw = false;\n            }\n        }\n    }\n}\n",{"version":3,"sources":["checkPhone.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"checkPhone.vue","sourceRoot":"src/view/login/password","sourcesContent":["<template>\n    <div class=\"login\">\n        <navBar title=\"重置密码\"></navBar>\n        <div class=\"from\">\n            <div class=\"from-item\">\n                <div class=\"from-item-title\">手机号码</div>\n                <div class=\"from-item-body\">\n                    <div class=\"left\">\n                        <van-dropdown-menu>\n                            <van-dropdown-item active-color=\"#435FE0\" v-model=\"value1\" :options=\"option1\"/>\n                        </van-dropdown-menu>\n                    </div>\n                    <div class=\"right\">\n                        <input type=\"number\" @input=\"handleGetStatus\" @focus=\"handleInputBlurBack\" v-model=\"mobile\" placeholder=\"请输入手机号码\"/>\n                    </div>\n                </div>\n            </div>\n            <div class=\"from-item\">\n                <div class=\"from-item-title\">手机验证码</div>\n                <div class=\"from-item-code\">\n                    <div class=\"left\">\n                        <input type=\"number\" v-model=\"code\" @focus=\"handleInputBlurBack\" @input=\"handleGetStatus\" placeholder=\"请输入手机验证\"/>\n                    </div>\n                    <div class=\"right\" @click=\"handleGetCode\" v-if=\"!isCode\">\n                        获取验证码\n                    </div>\n                    <div class=\"right\" v-else>\n                        <span>{{codeTime}}S</span>\n                    </div>\n                </div>\n            </div>\n            <div class=\"from-submit-active\" v-if=\"isActivw\" @click=\"handleNext\">下一步</div>\n            <div class=\"from-submit\" v-else>下一步</div>\n        </div>\n    </div>\n</template>\n\n<style src=\"./index.css\" scoped></style>\n\n<script>\n    import {DropdownMenu, DropdownItem, Toast} from 'vant';\n    import mixins from '../../../common/mixin';\n    import navBar from '../../../component/navBar';\n\n    export default {\n        components: {\n            DropdownMenu,\n            DropdownItem,\n            Toast,\n            navBar\n        },\n        mixins: [mixins],\n        data: () => ({\n            option1: [\n                {text: '+86', value: 0},\n                {text: '+89', value: 1},\n                {text: '+00', value: 2}\n            ],\n            mobile: '',       // 手机号码\n            code: '',         // 验证码\n            codeTime: 60,       // 手机倒计时\n            isCode: false,      // 是否显示发生验证码\n            isActivw: false,  // 是否激活登录按钮\n            value1: 0\n        }),\n        created() {\n\n        },\n        methods: {\n            handleNext: function () {\n                this.request({\n                    url: 'api/forgetPassword',\n                    method: 'POST',\n                    data: {\n                        mobile: this.mobile,\n                        code: this.code\n                    },\n                    success: (response) => {\n                        this.handleLogin();\n                    },\n                    error: (response) => {\n                    },\n                    complete: () => {\n                        Toast.clear();\n                    }\n                });\n            },\n            handleLogin: function () {\n                this.request({\n                    url: 'api/login',\n                    data: {\n                        mobile: this.mobile,\n                        code: this.code\n                    },\n                    success: (response) => {\n                        this.$router.replace({\n                            path: '/forgetPassword',\n                            query: {\n                                code: this.code\n                            }\n                        });\n\n                        // 存储access_token\n                        let access_token = response.token_type + ' ' + response.access_token;\n                        this.$storage.setToken(access_token);\n\n                        // 存储过期时间戳\n                        let d = new Date();\n                        let times = d.getTime() + response.expires_in\n                        this.$storage.setTimeStamp(times);\n                    },\n                    error: (response) => {\n                    },\n                    complete: () => {\n                        Toast.clear();\n                    }\n                });\n            },\n            handleGetCode: function () {\n                if(!this.handleChackPnone(this.mobile)){\n                    Toast(\"请输入正确的手机格式\");\n                    return;\n                }\n\n                Toast.loading({\n                    mask: true,\n                    message: '发送中...'\n                });\n\n                this.request({\n                    url: 'api/sendMobileCode',\n                    data: {\n                        mobile: this.mobile\n                    },\n                    success: (response) => {\n                        this.isCode = !this.isCode;\n\n                        let timer = setInterval(() => {\n                            if(this.codeTime > 0) {\n                                this.codeTime = this.codeTime - 1;\n                            } else {\n                                this.codeTime = 60;\n                                this.isCode = !this.isCode;\n\n                                clearInterval(timer)\n                            }\n                        }, 1000)\n                    },\n                    error: (response) => {\n                    },\n                    complete: () => {\n\n                    }\n                });\n            },\n            handleGetStatus: function (value) {\n                if(this.mobile.length > 11) {\n                    this.mobile = this.mobile.slice(0, 11)\n                    Toast(\"请输入正确的手机格式\");\n                    return;\n                }\n\n                if(this.mobile.length > 0 & this.code.length > 0) {\n                    this.isActivw = true;\n                } else{\n                    this.isActivw = false;\n                }\n            }\n        }\n    }\n</script>\n"]}]}