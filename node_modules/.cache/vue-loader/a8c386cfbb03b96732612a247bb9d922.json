{"remainingRequest":"/Users/lirongzhi/Documents/深圳善链/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lirongzhi/Documents/深圳善链/src/view/plus/committee/income/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lirongzhi/Documents/深圳善链/src/view/plus/committee/income/index.vue","mtime":1572538946833},{"path":"/Users/lirongzhi/Documents/深圳善链/node_modules/cache-loader/dist/cjs.js","mtime":1572539003414},{"path":"/Users/lirongzhi/Documents/深圳善链/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {Toast, Notify} from 'vant';\nimport navBar from '../../../../component/navBarTwo';\nimport mixins from '../../../../common/mixin';\nimport countTo from 'vue-count-to';\n\nexport default {\n    components: {\n        navBar,\n        Toast,\n        Notify,\n        countTo\n    },\n    mixins: [mixins],\n    data: () => ({\n        size: 15,\n        page: 1,\n        transferRecord: {},     // 请求回来的数据\n        historyList: [],        // 历史列表\n        loading: false,         // 滚动加载参数\n        finished: false,        // 滚动加载参数\n        income:0                //奖励余额\n    }),\n    created() {\n\n    },\n    mounted() {\n        this.handleLoad();\n        this.handleGetUserIncome();\n    },\n    beforeRouteEnter(to, from, next) {\n        next(vm=>{          //  这里的vm指的就是vue实例，可以用来当做this使用\n            sessionStorage.setItem('url_from', from.path);\n        })\n    },\n    methods: {\n        // 下拉加载\n        rollLoad: function() {\n            if(this.historyList.length < this.transferRecord.total) {\n                this.page += 1;\n                this.handleLoad();\n            } else{\n                this.loading = false;\n                this.finished = true;\n            }\n        },\n        // 初始化数据\n        handleLoad: function() {\n            this.request({\n                url: 'api/committee',\n                method: 'PATCH',\n                data: {\n                    size: this.size,\n                    page: this.page,\n                },\n                success: (response) => {\n                    this.transferRecord = response;\n                    console.log(response);\n                    // 把数组拼接上去\n                    this.historyList = this.historyList.concat(this.transferRecord.data);\n                },\n                error: (response) => {\n\n                },\n                complete: (response) => {\n                    // 关闭列表滚动\n                    this.loading = false;\n                    if(this.historyList.length >= this.transferRecord.total){\n                        this.finished = true;\n                    }\n                }\n            });\n        },\n        // 初始化用户奖励余额\n        handleGetUserIncome: function() {\n\n            this.request({\n                url: 'api/committee',\n                method: 'GET',\n                data: {\n                    type:1\n                },\n                success: (response) => {\n                    this.income = response.profit;\n                },\n                error: (response) => {\n\n                },\n                complete: (response) => {\n                    Toast.clear();\n                }\n            });\n        },\n    }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/view/plus/committee/income","sourcesContent":["<template>\n    <div class=\"income\">\n        <div class=\"top-bar\">\n            <div class=\"top-bar-box\">\n                <van-icon class=\"bar-back\" name=\"arrow-left\" @click=\"handleBack\" size=\"20\" />\n                自治委奖励\n            </div>\n        </div>\n        <div >\n            <div class=\"income-hender\">\n                <div class=\"circle-big\"></div>\n                <div class=\"circle-small\"></div>\n                <div class=\"income-money\">\n                    <div class=\"money\">\n                            <countTo  :startVal='0' :decimals=\"2\" :endVal='Number(income)' :duration='300'></countTo>\n                        <span class=\"font-utd\">UTD</span>\n                    </div>\n                    <div class=\"font-info\"><span>奖励锁仓</span></div>\n                </div>\n            </div>\n            <div class=\"income-body\">\n                <div class=\"record-head\">\n                    <span class=\"circle\"></span><p>奖励明细</p>\n                </div>\n                <div class=\"record\">\n                    <div class=\"no-data\"\n                         v-if=\"historyList.length <= 0\"\n                         style=\"padding-top: 80px\">\n                        <img src=\"./image/error.png\" class=\"no-data-image-icon\" alt=\"\">\n                        <p class=\"no-data-text\">暂无记录</p>\n                    </div>\n                    <van-list v-model=\"loading\"\n                              :finished=\"finished\"\n                              :offset=\"100\"\n                              v-if=\"historyList.length > 0\"\n                              :immediate-check=\"false\"\n                              finished-text=\"没有更多了\"\n                              @load=\"rollLoad\" >\n                        <div class=\"record-item\"\n                             v-for=\"(item, index) in historyList\"\n                             :key=\"index\">\n                            <div class=\"record-item-body\">\n                                <div class=\"record-item-body-info\">\n                                    <div class=\"record-item-body-icon\">\n                                        <img src=\"./image/utdcoin.png\" alt=\"\">\n                                    </div>\n\n                                    <div class=\"record-item-body-time\">\n                                        <span v-if=\"item.type == 1\">自治委奖励</span>\n                                        <span v-if=\"item.type == 2\">奖励解锁</span>\n                                        <span v-if=\"item.type == 3\">自治委员会扣除</span>\n                                        <span v-if=\"item.type == 4\">管理奖励</span>\n                                        <p>{{item.created_at}}</p>\n                                    </div>\n                                </div>\n                                <div class=\"record-item-body-number\">\n                                    <p v-if=\"item.type == 1 || item.type == 4\">\n                                        +<countTo :startVal='0' :decimals=\"2\" :endVal='Number(item.amount)' :duration='1'></countTo>\n                                    </p>\n                                    <p v-else>\n                                        -<countTo :startVal='0' :decimals=\"2\" :endVal='Number(item.amount)' :duration='1'></countTo>\n                                    </p>\n                                </div>\n                            </div>\n                        </div>\n                    </van-list>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<style src=\"./index.css\" scoped></style>\n\n<script>\n    import {Toast, Notify} from 'vant';\n    import navBar from '../../../../component/navBarTwo';\n    import mixins from '../../../../common/mixin';\n    import countTo from 'vue-count-to';\n\n    export default {\n        components: {\n            navBar,\n            Toast,\n            Notify,\n            countTo\n        },\n        mixins: [mixins],\n        data: () => ({\n            size: 15,\n            page: 1,\n            transferRecord: {},     // 请求回来的数据\n            historyList: [],        // 历史列表\n            loading: false,         // 滚动加载参数\n            finished: false,        // 滚动加载参数\n            income:0                //奖励余额\n        }),\n        created() {\n\n        },\n        mounted() {\n            this.handleLoad();\n            this.handleGetUserIncome();\n        },\n        beforeRouteEnter(to, from, next) {\n            next(vm=>{          //  这里的vm指的就是vue实例，可以用来当做this使用\n                sessionStorage.setItem('url_from', from.path);\n            })\n        },\n        methods: {\n            // 下拉加载\n            rollLoad: function() {\n                if(this.historyList.length < this.transferRecord.total) {\n                    this.page += 1;\n                    this.handleLoad();\n                } else{\n                    this.loading = false;\n                    this.finished = true;\n                }\n            },\n            // 初始化数据\n            handleLoad: function() {\n                this.request({\n                    url: 'api/committee',\n                    method: 'PATCH',\n                    data: {\n                        size: this.size,\n                        page: this.page,\n                    },\n                    success: (response) => {\n                        this.transferRecord = response;\n                        console.log(response);\n                        // 把数组拼接上去\n                        this.historyList = this.historyList.concat(this.transferRecord.data);\n                    },\n                    error: (response) => {\n\n                    },\n                    complete: (response) => {\n                        // 关闭列表滚动\n                        this.loading = false;\n                        if(this.historyList.length >= this.transferRecord.total){\n                            this.finished = true;\n                        }\n                    }\n                });\n            },\n            // 初始化用户奖励余额\n            handleGetUserIncome: function() {\n\n                this.request({\n                    url: 'api/committee',\n                    method: 'GET',\n                    data: {\n                        type:1\n                    },\n                    success: (response) => {\n                        this.income = response.profit;\n                    },\n                    error: (response) => {\n\n                    },\n                    complete: (response) => {\n                        Toast.clear();\n                    }\n                });\n            },\n        }\n    }\n</script>\n"]}]}