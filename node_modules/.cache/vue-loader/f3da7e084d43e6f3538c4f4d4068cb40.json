{"remainingRequest":"/Users/lirongzhi/Documents/深圳善链/h5/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lirongzhi/Documents/深圳善链/h5/src/view/my/shopkeeper/family.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lirongzhi/Documents/深圳善链/h5/src/view/my/shopkeeper/family.vue","mtime":1572538946811},{"path":"/Users/lirongzhi/Documents/深圳善链/h5/node_modules/cache-loader/dist/cjs.js","mtime":1572539003414},{"path":"/Users/lirongzhi/Documents/深圳善链/h5/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport mixins from '../../../common/mixin';\nimport navBar from '../../../component/navBar';\nimport { Toast, Dialog, Popup } from 'vant';\nimport countTo from 'vue-count-to';\n\nexport default {\n    components: {\n        navBar,\n        Dialog,\n        Toast,\n        Popup,\n        countTo\n    },\n    mixins: [mixins],\n    data: () => ({\n        isLoadSuccess: false,\t\t\t// 页面是否完成加载\n        warrant: {},\t\t\t\t\t// 加载回来的数据\n        account: '',\t\t\t\t\t// 登录用户手机\n        showImagePreview: false ,\t\t// 是否显示图片预览\n        show: false,                     //购买弹窗\n        buyingText:\"立即抢购\",                  //按钮文字提示\n        order:\"\",                           //订单编号\n        judge:false,                   //判断是否为家庭店主\n        accede:false,\n        isActivw:false,\n        codeTime: 60,       // 手机倒计时\n        isCode: false,      // 是否显示发生验证码\n        code:\"\",           //短信验证码\n        available:\"\",           //可用余额\n        handle:true,            //判断短信验证\n        usable:\"确认支付\",       //点击按钮文字\n\n    }),\n    created () {\n        this.handleGetUserInfo();\n        this.handleLoad();\n    },\n    // 设置路由钩子，存储页面来源\n    beforeRouteEnter(to, from, next) {\n        next(vm=>{          //  这里的vm指的就是vue实例，可以用来当做this使用\n            sessionStorage.setItem('url_from', from.path);\n        })\n    },\n    mounted () {\n\n\n    },\n    methods: {\n        //处理软键盘导致弹框里的按钮响应区域错位\n        scrollBack: function () {\n            setTimeout(function() {\n                var scrollHeight = document.documentElement.scrollTop || document.body.scrollTop || 0;\n                window.scrollTo(0, Math.max(scrollHeight - 1, 0));\n            }, 100);\n        },\n        // 初始化用户信息\n        handleGetUserInfo: function() {\n            this.request({\n                url: 'api/user',\n                method: 'GET',\n                data: { },\n                success: (response) => {\n                this.account=response.mobile\n\n                },\n                error: (response) => {\n\n                },\n                complete: (response) => {\n\n                }\n            });\n        },\n        //确认付款\n        affirmButten:function () {\n          //短信验证\n            this.request({\n                url: 'api/forgetPassword',\n                method: 'POST',\n                data: {\n                    mobile:this.account,\n                    code:this.code\n                },\n                success: (response) => {\n                    //提交下单\n                    this.request({\n                        url: 'api/warrant',\n                        method: 'PUT',\n                        data: {\n                            type:1\n                        },\n                        success: (response) => {\n                            this.show = false;\n                            this.judge =true;\n                            this.$router.go(0);\n                            Toast('家庭店主升级成功');\n                        },\n                        error: (response) => {\n                            this.show = false;\n                            this.code=\"\";\n                        },\n                        complete: (response) => {\n                        }\n                    });\n                },\n                error: (response) => {\n\n                },\n                complete: (response) => {\n                }\n            });\n\n\n        },\n        //获取验证码链接\n        handleGetCode: function () {\n            this.request({\n                url: 'api/sendMobileCode',\n                data: {\n                    mobile: this.account\n                },\n                success: (response) => {\n                    this.isCode = !this.isCode;\n\n                    let timer = setInterval(() => {\n                        if(this.codeTime > 0) {\n                            this.codeTime = this.codeTime - 1;\n                        } else {\n                            this.codeTime = 60;\n                            this.isCode = !this.isCode;\n\n                            clearInterval(timer)\n                        }\n                    }, 1000)\n                },\n                error: (response) => {\n                },\n                complete: () => {\n\n                }\n            });\n        },\n        //激活付款按钮\n        handleGetStatus:function () {\n            if(this.code.length === 6) {\n                this.isActivw = true;\n            } else{\n                this.isActivw = false;\n            }\n        },\n\n        //加入社区\n        community:function () {\n        this.accede =true\n        },\n        //家庭店主权益\n        handleLoad: function() {\n            this.request({\n                url: 'api/warrant',\n                method: 'GET',\n                data: {\n                    type:1\n                },\n                success: (response) => {\n\n                    this.warrant = response;\n\n                    if( response.type !== 0){\n                        this.judge =true;\n                    }\n                    //判断短信验证码显示隐藏\n                    if(Number(response.wallet.astir_currency) < Number(response.amount) ){\n                        this.handle = false;\n                        this.usable = \"可用余额不足\"\n                    }\n                    else {\n                        this.handle = true;\n                        this.usable = \"确认支付\"\n                    }\n                    //可用余额判断\n                    if(response.wallet.astir_currency === null){\n                        this.available = 0\n                    }else {\n                        this.available =  response.wallet.astir_currency;\n                    }\n\n\n                },\n                error: (response) => {\n                },\n                complete: (response) => {\n                }\n            });\n        },\n        cancel(){\n            this.show = false;\n            this.code=\"\";\n        },\n        showPopup() {\n            //家庭店主立即抢购\n            this.request({\n                url: 'api/warrant',\n                method: 'POST',\n                data: {\n                    type:1\n                },\n                success: (response) => {\n\n                    this.order =response\n                },\n                error: (response) => {\n\n                },\n                complete: (response) => {\n\n                }\n            });\n            this.show = true;\n        },\n        //跳转抢购规则\n        Buying:function () {\n            this.$router.push({\n                path: '/buying',\n                query: {\n                     id:1\n                }\n            });\n        }\n    }\n}\n",{"version":3,"sources":["family.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoHA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"family.vue","sourceRoot":"src/view/my/shopkeeper","sourcesContent":["<template>\n      <div class=\"creation\" >\n          <div class=\"creation-membership\">\n              <img v-if=\"judge\" src=\"./image/familyillume_01.png\" />\n              <img v-else=\"judge\" src=\"./image/family_01.png\"/>\n          </div>\n\n            <div class=\"creation-interests\">\n                  <div class=\"creation-interests-text\">\n                        <i></i>\n                        <i></i>\n                        <span>家庭店主权益</span>\n                        <i></i>\n                        <i></i>\n                  </div>\n\n                <!-- <div class=\"creation-purchase\" @click=\"Buying\">认购规则 ></div>-->\n                 <div class=\"creation-encourage\" v-if=\"warrant.storekeeper_info\">\n                       <div class=\"creation-encourage-content\">\n                           <img v-if=\"judge\" src=\"./image/encourageFamily_01.png\">\n                             <img v-else=\"judge\" src=\"./image/encourage_01.png\">\n                             <div>\n                                   <p>消费奖励</p>\n                                   <span>在缤纷集平台消费1元可获得5枚UTD奖励</span>\n                             </div>\n                       </div>\n                       <div class=\"creation-encourage-content\">\n                           <img v-if=\"judge\" src=\"./image/encourageFamily_02.png\">\n                           <img v-else=\"judge\" src=\"./image/encourage_02.png\">\n                             <div>\n                                   <p>店主奖励</p>\n                                   <span>自己和下级在缤纷集平台每消费1元，可获得1枚UTD奖励</span>\n                             </div>\n                       </div>\n                       <div class=\"creation-encourage-content\">\n                           <img v-if=\"judge\" src=\"./image/encourageFamily_03.png\">\n                           <img v-else=\"judge\" src=\"./image/encourage_03.png\">\n                             <div>\n                                   <p>首单奖励</p>\n                                   <span>邀请好友在缤纷集平台首次消费，可获得300枚UTD奖励</span>\n                             </div>\n                       </div>\n                       <div class=\"creation-encourage-content encourage-content-one \">\n                           <img v-if=\"judge\" src=\"./image/encourageFamily_04.png\">\n                           <img v-else=\"judge\" src=\"./image/encourage_04.png\">\n                             <div>\n                                   <p>评论奖励</p>\n                                   <span>在缤纷集平台订单完成后，对订单商品进行评价可获得25枚UTD奖励</span>\n                             </div>\n                       </div>\n\n                     <!--\n                       <div class=\"creation-encourage-content encourage-content-two\">\n                           <img v-if=\"judge\" src=\"./image/encourageFamily_06.png\">\n                           <img v-else=\"judge\" src=\"./image/encourage_06.png\">\n                             <div>\n                                   <p>{{warrant.storekeeper_info.profit[6][0]}}</p>\n                                   <span>{{warrant.storekeeper_info.profit[6][1][0]}}<br>\n                        {{warrant.storekeeper_info.profit[6][1][1]}}<br>\n                        {{warrant.storekeeper_info.profit[6][1][2]}}\n\n                                   </span>\n\n                             </div>\n                       </div>\n                      -->\n                 </div>\n           </div>\n\n           <div class=\"creation-rush\" v-if=\"judge\" @click=\"community\" >\n                 <p>加入社区</p>\n           </div>\n          <div class=\"creation-rush\" v-else @click=\"showPopup\">\n             <p>立即认购</p>\n          </div>\n          <van-popup :style=\"{width: '375px',height: '340px'}\" v-model=\"accede\" round><img  src=\"./image/community_01.png\" /></van-popup>\n           <van-popup\n                   v-model=\"show\"\n                   round\n                   position=\"bottom\"\n                   :style=\"{ height: '308px' }\"\n           >\n\n                 <div class=\"defrayal-one\">\n                       <div class=\"defrayal\">\n                             <p>UTD支付</p>\n                             <p @click=\"cancel\">取消</p>\n                       </div>\n                 </div>\n                 <div class=\"defrayal-one\">\n                       <div class=\"identifier\">\n                             <p>可用余额</p>\n                             <p><countTo :startVal='0' :decimals=\"2\" :endVal='Number(available)' :duration='1'></countTo>UTD</p>\n                       </div>\n                 </div>\n                 <div class=\"defrayal-two defrayal-one\">\n                       <div class=\"payoff\">\n                             <p>支付费用</p>\n                             <p><countTo :startVal='0' :decimals=\"2\" :endVal='Number(warrant.amount)' :duration='1'></countTo> UTD</p>\n                       </div>\n                       <div class=\"identifying\" v-if=\"handle\">\n                             <input type=\"text\" placeholder=\"请输入验证码\" v-model=\"code\" @input=\"handleGetStatus\" @blur=\"scrollBack\"/>\n                           <p @click=\"handleGetCode\" v-if=\"!isCode\">获取验证码</p>\n                           <p class=\"identifying-right\" v-else>{{codeTime}}S</p>\n                       </div>\n                 </div>\n\n               <div v-if=\"isActivw\" class=\"affirm-active\" @click=\"affirmButten\">确认支付</div>\n               <div v-else class=\"affirm\">{{usable}}</div>\n\n           </van-popup>\n\n     </div>\n</template>\n<style src=\"./family.css\" scoped></style>\n<script>\n   import mixins from '../../../common/mixin';\n   import navBar from '../../../component/navBar';\n   import { Toast, Dialog, Popup } from 'vant';\n   import countTo from 'vue-count-to';\n\n   export default {\n       components: {\n           navBar,\n           Dialog,\n           Toast,\n           Popup,\n           countTo\n       },\n       mixins: [mixins],\n       data: () => ({\n           isLoadSuccess: false,\t\t\t// 页面是否完成加载\n           warrant: {},\t\t\t\t\t// 加载回来的数据\n           account: '',\t\t\t\t\t// 登录用户手机\n           showImagePreview: false ,\t\t// 是否显示图片预览\n           show: false,                     //购买弹窗\n           buyingText:\"立即抢购\",                  //按钮文字提示\n           order:\"\",                           //订单编号\n           judge:false,                   //判断是否为家庭店主\n           accede:false,\n           isActivw:false,\n           codeTime: 60,       // 手机倒计时\n           isCode: false,      // 是否显示发生验证码\n           code:\"\",           //短信验证码\n           available:\"\",           //可用余额\n           handle:true,            //判断短信验证\n           usable:\"确认支付\",       //点击按钮文字\n\n       }),\n       created () {\n           this.handleGetUserInfo();\n           this.handleLoad();\n       },\n       // 设置路由钩子，存储页面来源\n       beforeRouteEnter(to, from, next) {\n           next(vm=>{          //  这里的vm指的就是vue实例，可以用来当做this使用\n               sessionStorage.setItem('url_from', from.path);\n           })\n       },\n       mounted () {\n\n\n       },\n       methods: {\n           //处理软键盘导致弹框里的按钮响应区域错位\n           scrollBack: function () {\n               setTimeout(function() {\n                   var scrollHeight = document.documentElement.scrollTop || document.body.scrollTop || 0;\n                   window.scrollTo(0, Math.max(scrollHeight - 1, 0));\n               }, 100);\n           },\n           // 初始化用户信息\n           handleGetUserInfo: function() {\n               this.request({\n                   url: 'api/user',\n                   method: 'GET',\n                   data: { },\n                   success: (response) => {\n                   this.account=response.mobile\n\n                   },\n                   error: (response) => {\n\n                   },\n                   complete: (response) => {\n\n                   }\n               });\n           },\n           //确认付款\n           affirmButten:function () {\n             //短信验证\n               this.request({\n                   url: 'api/forgetPassword',\n                   method: 'POST',\n                   data: {\n                       mobile:this.account,\n                       code:this.code\n                   },\n                   success: (response) => {\n                       //提交下单\n                       this.request({\n                           url: 'api/warrant',\n                           method: 'PUT',\n                           data: {\n                               type:1\n                           },\n                           success: (response) => {\n                               this.show = false;\n                               this.judge =true;\n                               this.$router.go(0);\n                               Toast('家庭店主升级成功');\n                           },\n                           error: (response) => {\n                               this.show = false;\n                               this.code=\"\";\n                           },\n                           complete: (response) => {\n                           }\n                       });\n                   },\n                   error: (response) => {\n\n                   },\n                   complete: (response) => {\n                   }\n               });\n\n\n           },\n           //获取验证码链接\n           handleGetCode: function () {\n               this.request({\n                   url: 'api/sendMobileCode',\n                   data: {\n                       mobile: this.account\n                   },\n                   success: (response) => {\n                       this.isCode = !this.isCode;\n\n                       let timer = setInterval(() => {\n                           if(this.codeTime > 0) {\n                               this.codeTime = this.codeTime - 1;\n                           } else {\n                               this.codeTime = 60;\n                               this.isCode = !this.isCode;\n\n                               clearInterval(timer)\n                           }\n                       }, 1000)\n                   },\n                   error: (response) => {\n                   },\n                   complete: () => {\n\n                   }\n               });\n           },\n           //激活付款按钮\n           handleGetStatus:function () {\n               if(this.code.length === 6) {\n                   this.isActivw = true;\n               } else{\n                   this.isActivw = false;\n               }\n           },\n\n           //加入社区\n           community:function () {\n           this.accede =true\n           },\n           //家庭店主权益\n           handleLoad: function() {\n               this.request({\n                   url: 'api/warrant',\n                   method: 'GET',\n                   data: {\n                       type:1\n                   },\n                   success: (response) => {\n\n                       this.warrant = response;\n\n                       if( response.type !== 0){\n                           this.judge =true;\n                       }\n                       //判断短信验证码显示隐藏\n                       if(Number(response.wallet.astir_currency) < Number(response.amount) ){\n                           this.handle = false;\n                           this.usable = \"可用余额不足\"\n                       }\n                       else {\n                           this.handle = true;\n                           this.usable = \"确认支付\"\n                       }\n                       //可用余额判断\n                       if(response.wallet.astir_currency === null){\n                           this.available = 0\n                       }else {\n                           this.available =  response.wallet.astir_currency;\n                       }\n\n\n                   },\n                   error: (response) => {\n                   },\n                   complete: (response) => {\n                   }\n               });\n           },\n           cancel(){\n               this.show = false;\n               this.code=\"\";\n           },\n           showPopup() {\n               //家庭店主立即抢购\n               this.request({\n                   url: 'api/warrant',\n                   method: 'POST',\n                   data: {\n                       type:1\n                   },\n                   success: (response) => {\n\n                       this.order =response\n                   },\n                   error: (response) => {\n\n                   },\n                   complete: (response) => {\n\n                   }\n               });\n               this.show = true;\n           },\n           //跳转抢购规则\n           Buying:function () {\n               this.$router.push({\n                   path: '/buying',\n                   query: {\n                        id:1\n                   }\n               });\n           }\n       }\n   }\n</script>\n\n<style scoped>\n\n</style>\n"]}]}