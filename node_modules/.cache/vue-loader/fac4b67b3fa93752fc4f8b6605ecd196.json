{"remainingRequest":"/Users/lirongzhi/Documents/深圳善链/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lirongzhi/Documents/深圳善链/src/view/plus/shopx/address/addressAdd.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lirongzhi/Documents/深圳善链/src/view/plus/shopx/address/addressAdd.vue","mtime":1572538946840},{"path":"/Users/lirongzhi/Documents/深圳善链/node_modules/cache-loader/dist/cjs.js","mtime":1572539003414},{"path":"/Users/lirongzhi/Documents/深圳善链/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport mixins from '../../../../common/mixin';\nimport areaList from '../../../../common/myarea';\nimport navBar from '../../../../component/navBar';\nimport {Toast} from 'vant';\n\nexport default {\n    components: {\n        navBar,\n        Toast\n    },\n    mixins: [mixins],\n    data: () => ({\n        areaList,\n        show: false,\n        address: {},\n        area: '',          //所选省市区\n        province: '',      //省\n        city: '',          //市\n        region: '',        //区\n        title: '新增地址',\n        is_default: false, //是否默认\n    }),\n    // 设置路由钩子，存储页面来源\n    beforeRouteEnter(to, from, next) {\n        next(vm => {          //  这里的vm指的就是vue实例，可以用来当做this使用\n            sessionStorage.setItem('url_from', from.path);\n        })\n    },\n    created() {\n    },\n    mounted() {\n        //是否为编辑地址\n        this.title = this.$route.query.title ? this.$route.query.title : this.title;\n        if (this.$route.query.address) {\n            let addr = this.$route.query.address;\n            this.address = addr;\n            this.area = addr.region.province + addr.region.city + addr.region.region;\n            this.province = addr.region.province;\n            this.city = addr.region.city;\n            this.region = addr.region.region;\n            this.is_default = addr.is_default;\n        }\n        this.handleAddressListLength();\n    },\n    methods: {\n        showPopup: function () {\n            this.show = !this.show;\n        },\n        chooseArea: function (val) {\n            this.area = val[0].name + val[1].name + val[2].name;\n            this.province = val[0].name;\n            this.city = val[1].name;\n            this.region = val[2].name;\n            this.showPopup();\n        },\n        handleAddressListLength(){\n            this.request({\n                url: 'api/store/address',\n                method: 'GET',\n                data: { },\n                success: (response) => {\n                    //新增的第一个地址为默认地址\n                    if (response.list.length == 0) {\n                        this.is_default = true;\n                    };\n                },\n                error: (response) => {\n\n                },\n                complete: (response) => {\n                }\n            });\n        },\n        //保存地址\n        handleSaveAddress: function () {\n            if (this.address.name < 2) {\n               Toast('收件人名称过短，建议至少两位数以上');\n               return\n            }\n            if (!this.address.phone) {\n                Toast('手机号码不能为空');\n                return\n            }\n            if (!this.handleChackPnone(this.address.phone.replace(/[ ]/g, \"\"))) {\n                Toast('请输入正确的手机格式');\n                return;\n            }\n            if (JSON.stringify(this.address.detail).length < 10) {\n                Toast('详细地址过短，建议至少十位数以上');\n                return\n            }\n\n            this.request({\n                url: 'api/store/address',\n                method: 'POST',\n                data: {\n                    \"id\": this.address.id ? this.address.id : null,\n                    \"name\": this.address.name,\n                    \"phone\": this.address.phone,\n                    \"province\": this.province,\n                    \"city\": this.city,\n                    \"region\": this.region,\n                    \"detail\": this.address.detail,\n                    \"is_default\": this.is_default ? 1 : 0\n                },\n                success: (response) => {\n                    this.$toast.center('保存成功');\n                    this.handleBack();\n                },\n                error: (response) => {\n\n                },\n                complete: (response) => {\n                }\n            });\n        },\n\n    }\n}\n",{"version":3,"sources":["addressAdd.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoDA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"addressAdd.vue","sourceRoot":"src/view/plus/shopx/address","sourcesContent":["<template>\n    <div class=\"addressAdd\">\n        <navBar :title=\"title\"></navBar>\n        <div>\n            <div class=\"address-info name\">\n                <div class=\"info-left\">收货人</div>\n                <div class=\"info-right\">\n                    <input type=\"text\" @focus=\"handleInputBlurBack\" v-model=\"address.name\" placeholder=\"请填写收人姓名\">\n                </div>\n            </div>\n            <div class=\"address-info phone\">\n                <div class=\"info-left\">联系电话</div>\n                <div class=\"info-right\">\n                    <input type=\"text\" @focus=\"handleInputBlurBack\" maxlength=\"11\" v-model=\"address.phone\" placeholder=\"请填写联系人手机号码\">\n                </div>\n            </div>\n            <div class=\"address-info area\" @click=\"showPopup\">\n                <div class=\"info-left\">省市区</div>\n                <div class=\"info-right\">\n                    <input type=\"text\" v-model=\"area\" placeholder=\"请选择省市区\" readonly=\"readonly\">\n                </div>\n                <i class=\"van-icon van-icon-arrow\"\n                   style=\"color: rgba(51, 51, 51, 0.5); font-size: 18px;\"><!----></i>\n            </div>\n            <div class=\"address-info detail\">\n                <div class=\"info-left\">详细地址</div>\n                <div><textarea rows=\"2\" @focus=\"handleInputBlurBack\" cols=\"28\" v-model=\"address.detail\" placeholder=\"街道、楼牌号等 \"/></div>\n            </div>\n<!--            <div class=\"address-info default\">-->\n<!--                <div class=\"info-left\">设为默认地址</div>-->\n<!--                <div class=\"info-right\"></div>-->\n<!--                <van-switch-->\n<!--                        v-model=\"is_default\"-->\n<!--                        active-color=\"#FE0000\"-->\n<!--                        inactive-color=\"#F5F5F5\"-->\n<!--                        size=\"18px\"-->\n<!--                />-->\n<!--            </div>-->\n        </div>\n        <van-popup v-model=\"show\"\n                   round\n                   position=\"bottom\">\n            <van-area :area-list=\"areaList\"\n                      :visible-item-count=\"6\"\n                      @cancel=\"showPopup\"\n                      @confirm=\"chooseArea\"/>\n        </van-popup>\n        <div class=\"save-btn\" @click=\"handleSaveAddress\">保存</div>\n    </div>\n</template>\n<style src=\"./addressAdd.css\" scoped></style>\n<script>\n    import mixins from '../../../../common/mixin';\n    import areaList from '../../../../common/myarea';\n    import navBar from '../../../../component/navBar';\n    import {Toast} from 'vant';\n\n    export default {\n        components: {\n            navBar,\n            Toast\n        },\n        mixins: [mixins],\n        data: () => ({\n            areaList,\n            show: false,\n            address: {},\n            area: '',          //所选省市区\n            province: '',      //省\n            city: '',          //市\n            region: '',        //区\n            title: '新增地址',\n            is_default: false, //是否默认\n        }),\n        // 设置路由钩子，存储页面来源\n        beforeRouteEnter(to, from, next) {\n            next(vm => {          //  这里的vm指的就是vue实例，可以用来当做this使用\n                sessionStorage.setItem('url_from', from.path);\n            })\n        },\n        created() {\n        },\n        mounted() {\n            //是否为编辑地址\n            this.title = this.$route.query.title ? this.$route.query.title : this.title;\n            if (this.$route.query.address) {\n                let addr = this.$route.query.address;\n                this.address = addr;\n                this.area = addr.region.province + addr.region.city + addr.region.region;\n                this.province = addr.region.province;\n                this.city = addr.region.city;\n                this.region = addr.region.region;\n                this.is_default = addr.is_default;\n            }\n            this.handleAddressListLength();\n        },\n        methods: {\n            showPopup: function () {\n                this.show = !this.show;\n            },\n            chooseArea: function (val) {\n                this.area = val[0].name + val[1].name + val[2].name;\n                this.province = val[0].name;\n                this.city = val[1].name;\n                this.region = val[2].name;\n                this.showPopup();\n            },\n            handleAddressListLength(){\n                this.request({\n                    url: 'api/store/address',\n                    method: 'GET',\n                    data: { },\n                    success: (response) => {\n                        //新增的第一个地址为默认地址\n                        if (response.list.length == 0) {\n                            this.is_default = true;\n                        };\n                    },\n                    error: (response) => {\n\n                    },\n                    complete: (response) => {\n                    }\n                });\n            },\n            //保存地址\n            handleSaveAddress: function () {\n                if (this.address.name < 2) {\n                   Toast('收件人名称过短，建议至少两位数以上');\n                   return\n                }\n                if (!this.address.phone) {\n                    Toast('手机号码不能为空');\n                    return\n                }\n                if (!this.handleChackPnone(this.address.phone.replace(/[ ]/g, \"\"))) {\n                    Toast('请输入正确的手机格式');\n                    return;\n                }\n                if (JSON.stringify(this.address.detail).length < 10) {\n                    Toast('详细地址过短，建议至少十位数以上');\n                    return\n                }\n\n                this.request({\n                    url: 'api/store/address',\n                    method: 'POST',\n                    data: {\n                        \"id\": this.address.id ? this.address.id : null,\n                        \"name\": this.address.name,\n                        \"phone\": this.address.phone,\n                        \"province\": this.province,\n                        \"city\": this.city,\n                        \"region\": this.region,\n                        \"detail\": this.address.detail,\n                        \"is_default\": this.is_default ? 1 : 0\n                    },\n                    success: (response) => {\n                        this.$toast.center('保存成功');\n                        this.handleBack();\n                    },\n                    error: (response) => {\n\n                    },\n                    complete: (response) => {\n                    }\n                });\n            },\n\n        }\n    }\n</script>\n\n"]}]}